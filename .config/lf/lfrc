map x delete
map p paste
map P select-all

map j updir
map k down
map l up
map รง open

map a push %touch<space>
map A push %mkdir<space>

map R :rename; cmd-home
map c :rename; cmd-delete-home
map C :rename; cmd-end; cmd-delete-home

map v toggle
map V invert
map u :unselect; clear

set hidden true

set previewer ctpv
set cleaner ctpvclear
&ctpv -s $id
&ctpvquit $id

# goto first file in the directory with gf
cmd goto-first-file &{{
    if [ -n "$(find -mindepth 1 -maxdepth 1 -type d -print -quit)" ]; then
        lf -remote "send $id :set dironly; bottom; set nodironly; down"
    else
        lf -remote "send $id top"
    fi
}}
map gf goto-first-file

# follows symbolic links with gL
cmd follow-link %{{
  lf -remote "send $id select \"$(readlink -- "$f" | sed 's/\\/\\\\/g;s/"/\\"/g')\""
}}
map gL follow-link

# repeats the last command on .
map . :read; cmd-history-prev; cmd-enter

cmd paste %{{
    load=$(cat ~/.local/share/lf/files)
    mode=$(echo "$load" | sed -n '1p')
    list=$(echo "$load" | sed '1d')
    if [ $mode = 'copy' ]; then
        cp -r "$list" .
    elif [ $mode = 'move' ]; then
        mv $list .
        rm ~/.local/share/lf/files
        lf -remote 'send clear'
    fi
}}

# quit to original directory in lfcd
map Q %lf -remote "send $id :cd \"$OLDPWD\"; quit"
